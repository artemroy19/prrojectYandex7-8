# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура проекта

В качестве архитектурного паттерна используется модель MVP (Model-View-Presenter).
Она разделяет приложение на три ключевых компонента: модель, представление и презентер. 



<img width="277" alt="Снимок экрана 2025-02-26 в 01 05 01" src="https://github.com/user-attachments/assets/731ee434-db92-4713-91d9-20563298ed28" />



Модель отвечает за обработку данных и реализацию бизнес-логики. 

Представление обеспечивает пользовательский интерфейс.

Презентер выступает в роли связующего звена между моделью и представлением. Он обрабатывает действия пользователя, передает данные между компонентами и управляет взаимодействием между моделью и представлением, обеспечивая четкое разделение ответственности.

## Описание базовых классов, их предназначение и функции

# Класс `EventEmitter`

Класс `EventEmitter` обеспечивает работу с событиями. 

Функциональность класса стандартная: возможность установить/снять слушатели событий, вызвать слушателей при возникновении события.

**Методы:**
- `on`: Устанавливает обработчик на событие.
- `off`: Снимает обработчик с события.
- `emit`: Инициирует событие с данными.
- `onAll`: Слушает все события.
- `offAll`: Сбрасывает все обработчики.
- `trigger`: Создает коллбек триггер, генерирующий событие при вызове.

# Класс `Api`

Класс `Api` хранит основные поля и методы, необходимые при работе с сервером. 

Функциональность класса: получать и хранить базовый URL (`baseUrl`) и опции запроса (`options`). Методы позволяют обработать запрос, отправить и получить данные.

**Методы:**
- `Конструктор`: Принимает на вход `baseUrl` и `options`, устанавливает заголовок `Content-Type` в `application/json`.
- `handleResponse`: Обрабатывает ответ сервера.
- `get`: Выполняет GET-запрос.
- `post`: Выполняет POST-запрос.

# Model

# Класс `LarekApi`

Класс LarekApi предназначен для взаимодействия с сетевым API в проекте.

Он расширяет функциональность базового класса Api и управляет запросами данных товаров и заказов.

**Методы:**
- `Конструктор`: Принимает передаваемые в родительский конструктор `Api` поля `baseUrl` и `options`, принимает и сохраняет входящий `url`.
- `getProductList`: Получает список товаров с сервера.
- `orderProducts`: Отправляет данные заказа на сервер.

# Класс `AppStates`

Класс AppStates представляет собой модель данных для всего приложения.

Он содержит данные каталога, корзины, превью товара, информации о заказе, а также методы для управления этими данными и их валидации.

**Методы:**
- `addToBasket`: Добавляет товар в корзину.
- `removeFromBasket`: Удаление товара из заказа.
- `updateBasket`: Обновляет данные корзины.
- `clearBasket`: Очищает данные корзины.
- `clearOrder`: Очищает данные заказа.
- `setCatalog`: Устанавливает данные для каталога товаров.
- `setPreview`: Устанавливает данные для превью товара.
- `setDelivery`: Устанавливает значение поля в данных доставки.
- `setContact`: Устанавливает значение поля в контактных данных.
- `validateDelivery`: Выполняет валидацию данных доставки.
- `validateContact`: Выполняет валидацию контактных данных.

**Поля:**
- `catalog`:Товары в каталоге.
- `basket`: Товары в корзине.
- `preview`: Товар в превью.
- `order`: Данные заказа, который отправляется на сервер.


# Класс `Product`

Класс Product представляет собой модель данных для отдельного товара.

Он хранит информацию о товаре, такую как идентификатор, заголовок, описание, изображение и цена.

# View

## Класс `Card`

Класс Card отвечает за отображение карточки товара в каталоге.

Поля класса управляют связью с разметкой, а методы наполняют эту разметку данными.


**Конструктор:**
- Принимает `container` типа `HTMLElement` и опциональный объект события `actions` типа `IActions`.
- Передает `container` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Если объект `actions` был передан, то вешает слушатель клика на `container` с вызовом объекта события `actions`.

**Поля:**
- `_title` — хранит разметку заголовка карточки.
- `_category` — хранит разметку категории карточки.
- `_image` — хранит разметку изображения карточки.
- `_price` — хранит разметку цены карточки.
- `_button` — хранит разметку кнопки карточки.
- `_categoryClasses` — словарь для дальнейшей модификации класса категории в зависимости от её содержимого.

**Методы:**
- `set title` — установка содержимого заголовка.
- `set category` — установка содержимого категории.
- `set image` — установка содержимого изображения.
- `set price` — установка содержимого цены.
- `set buttonTitle` — установка текста кнопки.
- `disablePriceButton` — блокировка кнопки, если цена равна `null`.

# Класс `Basket`

Отвечает за отображение корзины в модальном окне. Можно сказать, что служит контентом для модалки. Имеет возможность удаления позиции товара из корзины. Расширяется базовым абстрактным классом `Component` по интерфейсу `IBasket`.


**Конструктор:**
- Принимает `container` типа `HTMLElement` и объект `event` типа `IEvent`.
- Передает `container` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Если есть `button`, вешает на неё слушатель `click` с регистрацией события `order:open` в качестве колбека.

**Поля:**
- `_list` — хранит разметку обертки списка товаров.
- `_total` — хранит разметку для суммы товаров.
- `_button` — хранит разметку кнопки перехода на шаг оформления заказа.
- `items` — хранит список товаров в корзине.

**Методы:**
- `set items` — устанавливает товары в разметку `_list`
- `set total` — устанавливает значение суммы товаров.
- `toggleButton` — переключает состояние кнопки.

## Класс `Page`

Класс Page отвечает за отображение данных элементов страницы, таких как каталог товаров, корзина и счетчик товаров в корзине.

Методы управляют наполнением разметки данными, а также открытием и закрытием страницы с блокировкой прокрутки при открытии модального окна.


- Принимает `container` типа `HTMLElement` и объект `event` типа `IEvent`.
- Передает `container` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Вешает на кнопку корзины `basket` слушатель события `click`, при котором регистрируется событие `basket:open`.

**Методы:**
- `Конструктор`:
  •  Принимает container (HTMLElement) и event (IEvent).
  •  Передает container в конструктор родительского класса.
  •  Сохраняет элементы разметки в полях класса.
  •  Добавляет слушатель события click к кнопке корзины (basket), который вызывает событие basket:open.
- `set catalog`: Устанавливает разметку каталога товаров.
- `set counter`: Устанавливает значение счетчика товаров в корзине.
- `set locked`: Устанавливает класс, препятствующий прокрутке страницы при открытом модальном окне.

**Поля:**
- `counter`: Хранит разметку счетчика товаров в корзине.
- `catalog`: Хранит разметку каталога товаров.
- `wrapper`: Хранит разметку обертки страницы.
- `basket`: Хранит разметку кнопки корзины.


# Класс `Modal`

Отвечает за отображение модального окна. По сути своей является «коробкой» для любого содержимого. Потому и имеет минимальное количество полей и методов, которые связаны в основном с закрытием и открытием окна, а также наполнением его нужным контентом. Расширяется базовым абстрактным классом `Component` по интерфейсу `IModalData`.


**Конструктор:**
- Принимает `container` типа `HTMLElement` и объект `event` типа `IEvent`.
- Передает `container` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Вешает слушатель `click` на кнопку закрытия `_closeButton` и `container` с методом закрытия окна `close` в качестве колбека.
- Вешает слушатель `click` на `content`, для остановки распространения события при совершении клика на контенте модального окна.

**Поля:**
- `_closeButton` — разметка кнопки закрытия модального окна.
- `_content` — разметка контейнера для контента модального окна.

**Методы:**
- `set content` — устанавливает контент модального окна.
- `open` — открывает модальное окно.
- `close` — закрывает модальное окно.
- `render` — отрисовывает данные контента и открывает модальное окно.

# Класс `Form`

Отвечает за основные способы работы с формой и её валидацию. Класс является дженериком и принимает в переменной `T` тип данных компонента отображения. Расширяется базовым абстрактным классом `Component` по интерфейсу `IFormState`.


**Конструктор:**
- Принимает `container` типа `HTMLFormElement` и объект `event` типа `IEvent`.
- Передает `container` и `event` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Вешает на `container` слушатель `input`, при котором определяется поле воздействия, его имя и значение, которые после отправляются методу класса `onInputChange` в качестве аргументов.
- Вешает на `container` слушатель `submit`, при котором происходит регистрация события с указанием имени `container`.

**Поля:**
- `_submit` — хранит разметку кнопки отправки формы.
- `_errors` — хранит разметку вывода ошибок валидации.

**Методы:**
- `onInputChange` — регистрирует событие с именем конкретного поля.
- `set valid` — метод установки валидности.
- `set errors` — метод установки ошибки.
- `render` — отрисовка формы и её элементов.

# Класс `DeliveryForm` и `ContactForm`

Классы `DeliveryForm` и `ContactForm` отвечают за отображение первой и второй шагов заказа соответственно. Расширяются классом `Form` по интерфейсу `IOrderForm`.

**Конструктор:**
- Принимает `container` типа `HTMLFormElement` и объект `event` типа `IEvent`.

**Методы:**
- `toggleButtons`: Переключает активность кнопок.
- `set address`, `set phone`, `set email`: Устанавливают соответствующие поля формы.

# Класс `Success`

Отвечает за отображение успешного оформления заказа в модальном окне. Можно сказать, что служит контентом для модалки. Расширяется базовым абстрактным классом `Component` по интерфейсу `ISuccess`.

**Конструктор:**
- Принимает `container` типа `HTMLElement` и опциональный объект события `actions` типа `ISuccessActions`.
- Передает `container` в родительский конструктор.
- Сохраняет необходимые элементы разметки в полях.
- Если объект `actions` был передан, то вешает слушатель клика на `_close` с вызовом объекта события `actions`.

**Поля:**
- `_total` — разметка общей суммы товаров в заказе.
- `_close` — разметка кнопки закрытия окна.

**Методы:**
- `set total` — устанавливает значение общей суммы.

