# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура проекта

В качестве архитектурного паттерна используется модель MVP (Model-View-Presenter).
Она разделяет приложение на три ключевых компонента: модель, представление и презентер. 



<img width="277" alt="Снимок экрана 2025-02-26 в 01 05 01" src="https://github.com/user-attachments/assets/731ee434-db92-4713-91d9-20563298ed28" />



Модель отвечает за обработку данных и реализацию бизнес-логики. 

Представление обеспечивает пользовательский интерфейс.

Презентер выступает в роли связующего звена между моделью и представлением. Он обрабатывает действия пользователя, передает данные между компонентами и управляет взаимодействием между моделью и представлением, обеспечивая четкое разделение ответственности.

## Описание базовых классов, их предназначение и функции

# Класс `EventEmitter`

Класс `EventEmitter` обеспечивает работу с событиями. 

Функциональность класса стандартная: возможность установить/снять слушатели событий, вызвать слушателей при возникновении события.

**Методы:**
- `on`: Устанавливает обработчик на событие.
- `off`: Снимает обработчик с события.
- `emit`: Инициирует событие с данными.
- `onAll`: Слушает все события.
- `offAll`: Сбрасывает все обработчики.
- `trigger`: Создает коллбек триггер, генерирующий событие при вызове.

# Класс `Api`

Класс `Api` хранит основные поля и методы, необходимые при работе с сервером. 

Функциональность класса: получать и хранить базовый URL (`baseUrl`) и опции запроса (`options`). Методы позволяют обработать запрос, отправить и получить данные.

**Методы:**
- `Конструктор`: Принимает на вход `baseUrl` и `options`, устанавливает заголовок `Content-Type` в `application/json`.
- `handleResponse`: Обрабатывает ответ сервера.
- `get`: Выполняет GET-запрос.
- `post`: Выполняет POST-запрос.

# Model

# Класс `LarekApi`

Класс LarekApi предназначен для взаимодействия с сетевым API в проекте.

Он расширяет функциональность базового класса Api и управляет запросами данных товаров и заказов.

**Методы:**
- `Конструктор`: Принимает передаваемые в родительский конструктор `Api` поля `baseUrl` и `options`, принимает и сохраняет входящий `url`.
- `getProductList`: Получает список товаров с сервера.
- `orderProducts`: Отправляет данные заказа на сервер.

# Класс `AppStates`

Класс AppStates представляет собой модель данных для всего приложения.

Он содержит данные каталога, корзины, превью товара, информации о заказе, а также методы для управления этими данными и их валидации.

**Методы:**
- `addToBasket`: Добавляет товар в корзину.
- `removeFromBasket`: Удаление товара из заказа.
- `updateBasket`: Обновляет данные корзины.
- `clearBasket`: Очищает данные корзины.
- `clearOrder`: Очищает данные заказа.
- `setCatalog`: Устанавливает данные для каталога товаров.
- `setPreview`: Устанавливает данные для превью товара.
- `setDelivery`: Устанавливает значение поля в данных доставки.
- `setContact`: Устанавливает значение поля в контактных данных.
- `validateDelivery`: Выполняет валидацию данных доставки.
- `validateContact`: Выполняет валидацию контактных данных.

**Поля:**
- `catalog`:Товары в каталоге.
- `basket`: Товары в корзине.
- `preview`: Товар в превью.
- `order`: Данные заказа, который отправляется на сервер.


# Класс `Product`

Класс `Product` представляет собой модель данных для отдельного товара.

Он хранит информацию о товаре, такую как идентификатор, заголовок, описание, изображение и цена.




# View

## Класс `Card`

Класс `Card` отвечает за отображение карточки товара в каталоге.

Поля класса управляют связью с разметкой, а методы наполняют эту разметку данными.

**Поля:**
- `title`: Заголовка карточки.
- `category`: Категории карточки.
- `image`: Изображения карточки.
- `price`: Разметка цены карточки.
- `button`: Кнопка карточки.

**Методы:**
- `Конструктор`:
  - • Принимает `container` (HTMLElement) и `event` (IEvent).
  - • Передает `container` в конструктор родительского класса.
  - • Сохраняет элементы разметки в полях.
  - • Если объект `actions` был передан, то вешает слушатель клика на `container` с вызовом объекта события `actions`.
- `setTitle`: Устанавливает содержимое заголовка карточки.
- `setCategory`: Устанавливает содержимое категории карточки.
- `setImage`: Устанавливает содержимое изображения карточки.
- `setPrice`:  Устанавливает содержимое цены карточки.
- `setButtonTitle`: Устанавливает текст кнопки карточки.
- `disablePriceButton`: Блокирует кнопку, если цены товара нет.


# Класс `Basket`

Класс `Basket` отвечает за отображение корзины товаров в модальном окне.

Он предоставляет возможность удалять товары из корзины и служит контентом для модального окна.

**Поля:**
- `list`: Обертка списка товаров.
- `items`: Список товаров в корзине.
- `total`: Суммы товаров.
- `button`: Кнопа перехода на оформление заказа.

**Методы:**
- `Конструктор`:
  - • Принимает `container` (HTMLElement) и `event` (IEvent).
  - • Передает `container` в конструктор родительского класса.
  - • Сохраняет элементы разметки в полях.
  - • Если есть `button`, вешает на неё слушатель `click` с регистрацией события `order:open` в качестве колбека.
- `setItems` — устанавливает товары в разметку `_list`
- `setTotal` — устанавливает значение суммы товаров.
- `toggleButton` — переключает состояние кнопки.

## Класс `Page`

Класс `Page` отвечает за отображение данных элементов страницы, таких как каталог товаров, корзина и счетчик товаров в корзине.

Методы управляют наполнением разметки данными, а также открытием и закрытием страницы с блокировкой прокрутки при открытии модального окна.

**Поля:**
- `counter`: Хранит разметку счетчика товаров в корзине.
- `catalog`: Хранит разметку каталога товаров.
- `wrapper`: Хранит разметку обертки страницы.
- `basket`: Хранит разметку кнопки корзины.

**Методы:**
- `Конструктор`:
  - •  Принимает `container` (HTMLElement) и `event` (IEvent).
  - •  Передает `container` в конструктор родительского класса.
  - •  Сохраняет элементы разметки в полях класса.
  - •  Добавляет слушатель события click к кнопке корзины `basket`, который вызывает событие открытой корзины.
- `set catalog`: Устанавливает разметку каталога товаров.
- `set counter`: Устанавливает значение счетчика товаров в корзине.
- `set locked`: Устанавливает класс, препятствующий прокрутке страницы при открытом модальном окне.

# Класс `Modal`

Класс `Modal` отвечает за отображение модального окна.

Он представляет собой контейнер для любого контента и управляет открытием и закрытием окна.

**Поля:**
- `closeButton` — Кнопка закрытия модального окна.
- `content` —  Контейнер для контента модального окна.

**Методы:**
- `Конструктор`:
  - •  Принимает `container` (HTMLElement) и `event` (IEvent).
  - •  Передает `container` в конструктор родительского класса.
  - •  Сохраняет элементы разметки в полях.
  - •  Привязывает обработчик события click к кнопке закрытия `closeButton` и container, вызывающий метод `close` для закрытия окна.
- `set content`: Устанавливает контент модального окна.
- `render`: Отрисовывает контент и открывает модальное окно.
- `open`: Открывает модальное окно.
- `close`: Закрывает модальное окно.


# Класс `Form`

Класс `Form` отвечает за работу с формой и её валидацию.

Он является дженериком и принимает тип данных компонента отображения.

**Поля:**
- `submit` —  Кнопка отправки формы.
- `errors` —  Вывод ошибок валидации.

**Методы:**
- `Конструктор`:
  - •  Принимает `container` (HTMLElement) и `event` (IEvent).
  - •  Передает `container` в конструктор родительского класса.
  - •  Сохраняет элементы разметки в полях.
  - •  Добавляет обработчик события `input` к `container`, который определяет поле, его имя и значение, а затем передает их в метод `onInputChange`.
  - •  Добавляет обработчик события `submit` к `container`, регистрирующий событие с указанием имени `container`.
- `onInputChange`: Регистрирует событие при изменении значения поля формы.
- `set valid`: Устанавливает состояние валидности формы.
- `set errors`: Устанавливает ошибки валидации формы.
- `render`: Отрисовывает форму и ее элементы.
  
# Класс `DeliveryForm` и `ContactForm`

Классы `DeliveryForm` и `ContactForm` отвечают за отображение шагов оформления заказа (адрес доставки и контактная информация).

Они расширяют класс Form и управляют полями ввода на соответствующих этапах.

**Поля:**
- `address` — Адресс.
- `phone` — Телефон.
- `email` — email.

**Методы:**
- `Конструктор`:
  - • Принимает `container` (HTMLElement) и `event` (IEvent).
- `toggleButtons`: Переключает активность кнопок.
- `setAddress`: Устанавливает значение поля адреса доставки.
- `setPhone`: Устанавливает значение поля телефона.
- `setEmail`: Устанавливает значение поля email.

# Класс `Success`

Класс `Success` отвечает за отображение информации об успешном оформлении заказа в модальном окне.

Он служит контентом для модального окна и показывает итоговую сумму заказа.

**Поля:**
- `total` — Общая суммы товаров в заказе.
- `close` — Кнопки закрытия окна.

**Методы:**
- `Конструктор`:
  - • Принимает `container` (HTMLElement) и `event` (IEvent).
  - • Передает `container` в конструктор родительского класса.
  - • Сохраняет элементы разметки в полях.
  - • Если объект `actions` передан, привязывает обработчик события click к элементу `close`, вызывающий соответствующий метод из объекта `actions`.
- `setTotal`: Устанавливает значение общей суммы заказа.

